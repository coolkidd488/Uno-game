<!DOCTYPE html><html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>UNO Online â€“ Supabase</title>
<style>
body{margin:0;font-family:Arial;background:#0f172a;color:#fff}
.area{background:#020617;margin:10px;padding:12px;border-radius:12px}
.hidden{display:none}
button,input{padding:10px;border-radius:10px;border:none;font-weight:bold;margin:4px}
#players div{background:#111827;padding:6px;border-radius:6px;margin:4px 0}
</style>
</head>
<body><div id="login" class="area">
  <h2>Seu nome</h2>
  <input id="name" placeholder="Digite seu nome" />
  <button onclick="goMenu()">Continuar</button>
</div><div id="menu" class="area hidden">
  <button onclick="createRoom()">Criar sala</button>
  <br />
  <input id="roomInput" placeholder="CÃ³digo da sala" />
  <button onclick="joinRoom()">Entrar</button>
</div><div id="room" class="area hidden">
  <h3>Sala: <span id="roomCode"></span></h3>
  <strong>Jogadores:</strong>
  <div id="players"></div>
  <button onclick="startGame()">Iniciar jogo</button>
</div><script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script><script>
// ================= SUPABASE =================
const SUPABASE_URL = 'https://ozybsjswoncgkusjeqqm.supabase.co';
const SUPABASE_KEY = 'sb_publishable_gRKp6oykV2lFFXdWjX1xOw_WpqgKmiX';

const { createClient } = supabase;
const db = createClient(SUPABASE_URL, SUPABASE_KEY);

// ================= ELEMENTOS =================
const login = document.getElementById('login');
const menu = document.getElementById('menu');
const room = document.getElementById('room');
const roomCodeSpan = document.getElementById('roomCode');

// ================= VARIÃVEIS =================
let playerName = '';
let roomCode = '';
let playerId = Date.now().toString();

// ================= FUNÃ‡Ã•ES =================
function goMenu(){
  playerName = document.getElementById('name').value.trim();
  if(!playerName) return alert('Digite um nome');
  login.classList.add('hidden');
  menu.classList.remove('hidden');
}

async function createRoom(){
  roomCode = Math.floor(100000 + Math.random()*900000).toString();
  await db.from('rooms').insert({ code: roomCode });
  await db.from('players').insert({ room: roomCode, name: playerName, pid: playerId });
  openRoom();
}

async function joinRoom(){
  roomCode = document.getElementById('roomInput').value.trim();
  if(!roomCode) return alert('Digite o cÃ³digo da sala');
  await db.from('players').insert({ room: roomCode, name: playerName, pid: playerId });
  openRoom();
}

function openRoom(){
  menu.classList.add('hidden');
  room.classList.remove('hidden');
  roomCodeSpan.innerText = roomCode;
  loadPlayers();
}

async function loadPlayers(){
  const { data, error } = await db.from('players').select('*').eq('room', roomCode);
  if(error) return;
  const list = document.getElementById('players');
  list.innerHTML = '';
  data.forEach(p => {
    const d = document.createElement('div');
    d.innerText = p.name;
    list.appendChild(d);
  });
}

// Atualiza a lista a cada 1 segundo
setInterval(() => {
  if(roomCode) loadPlayers();
}, 1000);

function startGame(){
  alert('Aqui entra o UNO online completo ðŸ˜„');
}
</script></body>
</html>
